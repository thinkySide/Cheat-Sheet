# âœ… DispatchQueueì— ì˜ˆì•½ëœ ì‘ì—… ì·¨ì†Œí•˜ê¸°

## **ğŸ”** ì‘ì„± ëª©ì 

ì»¤ìŠ¤í…€ Toast íŒì—…ë©”ì‹œì§€ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ê³ êµ°ë¶„íˆ¬í•˜ë˜ ì¤‘, DispatchQueueë¥¼ ì´ìš©í•´ 2ì´ˆ ë’¤ì— ë‹¤ì‹œ ì‚¬ë¼ì§€ê²Œ í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•˜ê³  ìˆì—ˆë‹¤. í•œë²ˆë§Œ í„°ì¹˜í–ˆì„ ë•ŒëŠ” ë¬¸ì œê°€ ì—†ì§€ë§Œ, ì—¬ëŸ¬ë²ˆ í„°ì¹˜í•˜ê²Œë˜ë©´ ëŒ€ê¸°ì—´ì— ì‘ì—…ì´ ì£¼êµ¬ì¥ì°½ ìŒ“ì´ê²Œ ë˜ì–´ íŒì—…ì´ ì‚¬ë¼ì§€ëŠ” ì‹œê°„ì´ ë“¤ì­‰ë‚ ì­‰í•˜ê²Œ ë³´ì¸ë‹¤ëŠ” ë¬¸ì œê°€ ìˆì–´ ì´ë¯¸ ì˜¬ë¼ê°„ ëŒ€ê¸°ì—´ì„ ì‚­ì œí•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë´¤ë‹¤.

~~~swift
// ê¸°ì¡´ ì½”ë“œ

/// í† ìŠ¤íŠ¸ ë©”ì‹œì§€ë¥¼ ì¶œë ¥í•˜ëŠ” ë©”ì„œë“œ
private func showToast(is active: Bool) {
    
    // í† ìŠ¤íŠ¸ í™œì„±í™”
    if active {

        // í† ìŠ¤íŠ¸ ë„ìš°ê¸°
        UIView.animate(withDuration: 0.2) { self.viewManager.toastView.alpha = 1 }
        
        // 2ì´ˆ ë’¤ ë¹„í™œì„±í™”
        DispatchQueue.main.asyncAfter(deadline: .now()+2) {
            UIView.animate(withDuration: 0.2) { self.viewManager.toastView.alpha = 0 }
        }
    }
}
~~~

<br>

## ğŸ“Œ ì ìš© ë°©ë²•

### 1. DispatchWorkItemì— ì‹¤í–‰í•  ì‘ì—… ë‹´ê¸°

ìš°ì„  ë‚´ê°€ ëŒ€ê¸°ì—´ì— ì˜¬ë¦° ì‘ì—…ì´ ë¬´ìŠ¨ ì‘ì—…ì¸ì§€ íŠ¹ì •í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì—, `DispatchWorkItem`ì— ì „ì—­ë³€ìˆ˜ë¡œ ë‹´ëŠ”ë‹¤.

~~~swift
// 1. ì „ì—­ë³€ìˆ˜ ìƒì„±
var workItem: DispatchWorkItem?
~~~

<br>

### 2. ì‹¤ì œ ë™ì‘ ì½”ë“œ ì‘ì„±í•˜ê¸°

ì´ ì•„ì´í…œì€ ë¬´ìŠ¨ ì‘ì—…ì¸ì§€ ì½”ë“œë¡œ ì‘ì„±í•´ ì¤€ë‹¤.

~~~swift
var workItem: DispatchWorkItem?

private func showToast(is active: Bool) {
    if active {
        UIView.animate(withDuration: 0.2) { self.viewManager.toastView.alpha = 1 }

        // 2. WorkItemì— ì‹¤í–‰í•  ì‘ì—… ì½”ë“œë¥¼ ì‘ì„±í•´ì¤€ë‹¤.
        workItem = DispatchWorkItem {
            UIView.animate(withDuration: 0.2) { self.viewManager.toastView.alpha = 0 }
        }
    }
}
~~~

<br>

### 3. 2ì´ˆë’¤ì— ì‹¤í–‰ì‹œì¼œì£¼ëŠ” ì½”ë“œì— ë‹´ëŠ”ë‹¤.

ì—¬ê¸°ê¹Œì§€ëŠ” ë™ì¼í•˜ë‹¤ê³  ë³´ë©´ ëœë‹¤. ë‹¨ì§€ ì•„ì´í…œì— ì‘ì—…ì„ ë„£ì–´ì£¼ëŠ” ê³¼ì •ì¼ ë¿!

~~~swift
var workItem: DispatchWorkItem?

private func showToast(is active: Bool) {
    if active {
        UIView.animate(withDuration: 0.2) { self.viewManager.toastView.alpha = 1 }

        workItem = DispatchWorkItem {
            UIView.animate(withDuration: 0.2) { self.viewManager.toastView.alpha = 0 }
        }

        // 3. 2ì´ˆ ë’¤ì— ì‹¤í–‰í•  ì½”ë“œì— ì•„ì´í…œ ë‹´ì•„ì£¼ê¸°
        DispatchQueue.main.asyncAfter(deadline: .now()+2, execute: workItem!)
    }
}
~~~

<br>

### 4. ì‘ì—…ì„ ì·¨ì†Œí•˜ê³  ì‹¶ì€ ì‹œì ì— cancel() ë©”ì„œë“œ ì‚½ì…

ê°€ì¥ ì¤‘ìš”í•œ `cancel` ë©”ì„œë“œ ì‚¬ìš©! ëŒ€ê¸°ì—´ì— ì˜¬ë¼ê°€ ìˆëŠ” ì‘ì—…ì„ ì·¨ì†Œí•´ì¤€ë‹¤.

~~~swift
var workItem: DispatchWorkItem?

private func showToast(is active: Bool) {

    // 4. ë‹¤ì‹œ í† ìŠ¤íŠ¸ ì¶œë ¥ ì‹œ ëŒ€ê¸°ì—´ì— ì˜¬ë¼ê°„ ì‘ì—…ì„ ì·¨ì†Œí•´ì•¼í•˜ë¯€ë¡œ ë©”ì„œë“œ ìµœìƒë‹¨ì— ì‘ì„±
    workItem?.cancel()

    if active {
        UIView.animate(withDuration: 0.2) { self.viewManager.toastView.alpha = 1 }

        workItem = DispatchWorkItem {
            UIView.animate(withDuration: 0.2) { self.viewManager.toastView.alpha = 0 }
        }

        DispatchQueue.main.asyncAfter(deadline: .now()+2, execute: workItem!)
    }
}
~~~