# ğŸš§ CoreData ì €ì¥ì´ ì•ˆë˜ëŠ” ë¬¸ì œ

## ğŸ¤” ë¬¸ì œ ì •ì˜

ì˜¤ëœë§Œì— ë‹¤ì‹œ ì‹œì‘í•œ DayBlock í”„ë¡œì íŠ¸, ê°€ì¥ ì¤‘ìš”í•œ CoreDataë¥¼ ì ìš©í•˜ê¸° ìœ„í•´ ì „ì²´ì ìœ¼ë¡œ ê°ˆì•„ ì—ëŠ”ì¤‘,, ë¶„ëª… ì˜ ì €ì¥í•˜ê³  ìˆëŠ” ê±° ê°™ì€ë° ì•± ì¢…ë£Œ í›„ ë‹¤ì‹œ ë“¤ì–´ê°€ë³´ë©´ ì´ˆê¸°í™”ë˜ì–´ìˆëŠ” ìƒí™©ì´ ê³„ì†ë˜ì–´ ì–´ë–¤ ë¬¸ì œì¸ì§€ ì•Œì•„ë³´ê¸°ë¡œ í–ˆë‹¤.

<img width="300" src="https://github.com/thinkySide/DayBlock/assets/113565086/9eb6861e-2a2d-40e7-adf9-cc35847788fa">

~~~swift
// blockManager.swift

/// ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ìš© ë°°ì—´
private var groupList = [Group(name: "ê·¸ë£¹ ì—†ìŒ", color: 0x323232, list: [])]

/// ì½”ì–´ë°ì´í„°ìš© ë°°ì—´
var groupEntity: [GroupEntity] = []
    
/// ì»¨í…ìŠ¤íŠ¸
let context = (UIApplication.shared.delegate as! AppDelegate).persistentContainer.viewContext

/// Entity Fetch
func getAllItems() {
        do {
            // Entity ë¶ˆëŸ¬ì˜¤ê¸°
            groupEntity = try context.fetch(GroupEntity.fetchRequest())
                
            // ë¹„ì¦ˆë‹ˆìŠ¤ìš© ë°°ì—´ì— Entity ê°’ ë¶ˆëŸ¬ì™€ì„œ ì¶”ê°€í•˜ê¸°
            for item in groupEntity {
                groupList.append(Group(name: item.name, color: item.color, list: []))
            }
        } catch {
            // error
        }
    }

// Create Item
func createItem(group: Group) {
        
    // ìƒˆë¡œìš´ ì•„ì´í…œ ìƒì„±
    let newItem = GroupEntity(context: context)
    newItem.name = group.name
    newItem.color = group.color
        
    // ì»¨í…ìŠ¤íŠ¸ì— ì €ì¥
    do {
        try context.save()
    } catch {
        // error
    }
}

// ê·¸ë£¹ ìƒì„±
func createNewGroup() {
    let newGroup = remoteGroup
    createItem(group: newGroup)
    getAllItems()
    resetRemoteGroup()
}
~~~

<br>

~~~swift
// HomeViewController.swift
override func viewDidLoad() {
    super.viewDidLoad()
    blockManager.getAllItems()
}
~~~

<br>

~~~swift
// CreateGroupViewController.swift
func createGroup() {
    /// ë¦¬ëª¨íŠ¸ ê·¸ë£¹ ì—…ë°ì´íŠ¸
    guard let groupName = viewManager.groupLabelTextField.textField.text else { return }
    blockManager.updateRemoteGroup(name: groupName)
        
    /// ê·¸ë£¹ ìƒì„±
    blockManager.createNewGroup()
        
    /// selectViewì˜ ê·¸ë£¹ ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
    delegate?.updateGroupList()
    dismiss(animated: true)
}
~~~

<br>

## ğŸª“ ì‚½ì§ˆ ê¸°ë¡

### 1. í…ŒìŠ¤íŠ¸ í”„ë¡œì íŠ¸ ë§Œë“¤ì–´ë³´ê¸°
DayBlock í”„ë¡œì íŠ¸ì—ì„œ êµ¬í˜„í•˜ë ¤ê³  í•˜ëŠ” ê²Œ ë‚˜ë¦„(?) ì–´ë ¤ì›Œ ë‹¤ë¥¸ ë¡œì§ë•Œë¬¸ì— ê·¸ëŸ°ê°€? ë¼ê³  ìƒê°ì„ í•´ í…ŒìŠ¤íŠ¸ í”„ë¡œì íŠ¸ë¥¼ ë”°ë¡œ íŒŒ ì‘ì„±í•´ë´¤ë‹¤. ê²°ê³¼ëŠ” ë˜‘ê°™ë‹¤,, ë­”ê°€ ì½”ì–´ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ê±° ê°™ê¸°ëŠ” í•œë° ì €ì¥ì´ ì•ˆë˜ëŠ”,,? ë¬´ìŠ¨ í˜„ìƒì¼ê¹Œ

<img width="300" src="https://github.com/thinkySide/DayBlock/assets/113565086/698a0869-801c-4066-a44a-ea667f169409">

<br>

### 2. Entity ë°”ê¿”ë³´ê¸°
GroupList Entityì—ì„œëŠ” [Block] ì»¤ìŠ¤í…€ íƒ€ì…ì„ ë‹´ê¸°ìœ„í•´ transformable íƒ€ì…ì„ ì‚¬ìš©í•˜ê³  ìˆì—ˆë‹¤. ìš”ê²Œ ë¬¸ì œì¸ê°€ ì‹¶ì–´ì„œ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ëŠ” íƒ€ì…ìœ¼ë¡œë§Œ ìƒˆë¡œ Entityë¥¼ ë§Œë“  í›„ í…ŒìŠ¤íŠ¸ í•´ë´¤ëŠ”ë°! ì´ì œëŠ” ì €ì¥ì´ ëœë‹¤. ë¬¸ì œëŠ” transformableì—ì„œ ë‚˜ì˜¤ê³  ìˆì—ˆë˜ ê²ƒ! ì–´ë–¤ ë¬¸ì œ ë•Œë¬¸ì¸ì§€ íŒŒì•…í•´ì•¼í•  ì°¨ë¡€ì´ë‹¤.

<br>

## ğŸ’Œ Ref.